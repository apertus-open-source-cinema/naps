

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project setup &amp; installation &mdash; naps  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting started" href="getting_started.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            naps
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Project setup &amp; installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-new-out-of-tree-project">Creating a new out-of-tree project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-an-new-in-tree-project">Creating an new in-tree project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-vendor-toolchain-tools">Installing the vendor toolchain &amp; tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="naps.soc.html">naps.soc</a></li>
<li class="toctree-l1"><a class="reference internal" href="naps.platform.html">naps.platform</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">naps</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Project setup &amp; installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="project-setup-installation">
<h1>Project setup &amp; installation<a class="headerlink" href="#project-setup-installation" title="Link to this heading"></a></h1>
<p>There are two ways of using naps: You can either install it as a normal Python
dependency or develop your project inside the naps source-tree. Developing in-tree
is of advantage if you plan to write large cores that could benefit other projects
and could thus be upstreamed. We currently don’t have a very strict definition of
the scope of things that can live in the naps package and are generally open to
merge other cores / experiments into the codebase.</p>
<p>Upstreaming your projects has the advantage that we catch regressions
when changing internals as none of the interfaces of the naps package currently
provide any stability guarantees. So if the code you write could be useful over a
prologed timespan, consider upstreaming it.</p>
<p>If you however only intend to make a short hack or try something out, it is
better to develop code out-of-tree. This way we can reduce maintainance burden
and limit the growth of the codebase.</p>
<section id="creating-a-new-out-of-tree-project">
<h2>Creating a new out-of-tree project<a class="headerlink" href="#creating-a-new-out-of-tree-project" title="Link to this heading"></a></h2>
<p>For creating a new out-of-tree project, we recommend to use <a class="reference external" href="https://github.com/pdm-project/pdm/">pdm</a>.
run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdm</span> <span class="n">new</span> <span class="o">&lt;</span><span class="n">project</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
<span class="n">cd</span> <span class="o">&lt;</span><span class="n">project</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
<span class="n">pdm</span> <span class="n">add</span> <span class="n">naps</span>
<span class="n">pdm</span> <span class="n">add</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">amaranth</span><span class="o">-</span><span class="n">lang</span><span class="o">/</span><span class="n">amaranth</span><span class="o">-</span><span class="n">boards</span>
</pre></div>
</div>
</section>
<section id="creating-an-new-in-tree-project">
<h2>Creating an new in-tree project<a class="headerlink" href="#creating-an-new-in-tree-project" title="Link to this heading"></a></h2>
<p>For creating a new in-tree project, just clone the naps repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">apertus</span><span class="o">-</span><span class="nb">open</span><span class="o">-</span><span class="n">source</span><span class="o">-</span><span class="n">cinema</span><span class="o">/</span><span class="n">naps</span>
<span class="n">cd</span> <span class="n">naps</span>
<span class="n">pdm</span> <span class="n">install</span>
</pre></div>
</div>
<p>We call project entrypoints “applets”. If you want
to start a new design, simply create a new python file in the <code class="docutils literal notranslate"><span class="pre">applets/</span></code>
directory.</p>
</section>
<section id="installing-the-vendor-toolchain-tools">
<h2>Installing the vendor toolchain &amp; tools<a class="headerlink" href="#installing-the-vendor-toolchain-tools" title="Link to this heading"></a></h2>
<p>For using Amaranth (and thus for using naps), you need a working copy of yosys. Because naps also calls
yosys internally, it is best to install the full version (not amaranth-yowasp). The
easiest way to do that is to install <a class="reference external" href="https://github.com/YosysHQ/oss-cad-suite-build">oss-cad-suite</a>.
If you only want to develop for Lattice ECP5, you are now done.</p>
<p>If you want to develop for Xilinx Zynq, you additionally need to install Vivado.
The naps cli can handle Vivado inside docker, which is handy for example on macOS
(see <a class="reference external" href="https://github.com/ichi4096/vivado-on-silicon-mac">this repo</a> for an example on how to do this).
For this, you need to supply the environment variable <code class="docutils literal notranslate"><span class="pre">NAPS_BUILD_DOCKER_IMAGE</span></code>
and <code class="docutils literal notranslate"><span class="pre">NAPS_BUILD_DOCKER_ARGS</span></code>. If you have vivado installed natively, you have to supply
the environment variable <code class="docutils literal notranslate"><span class="pre">AMARANTH_ENV_VIVADO</span></code>.</p>
<p>For using the <code class="docutils literal notranslate"><span class="pre">JTAGSoc</span></code> you also need to install openocd. The current platforms
assume that you use a jlink JTAG probe but that can easily be changed (just search for
<code class="docutils literal notranslate"><span class="pre">jlink</span></code> in the code).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="getting_started.html" class="btn btn-neutral float-right" title="Getting started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Robin Heinemann, Jaro Habiger.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>